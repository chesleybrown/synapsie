{% extends "base.html" %}

{% load i18n %}
{% load tag %}

{% block extra_head_base %}
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/reset.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/960.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/text.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/base.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/records.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/tags.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/icons.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/tabs.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/charts.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/jquery.datePicker.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/jquery.gritter.css" />
	{% block extra_head %}{% endblock %}
{% endblock %}

{% block identity %}
	{% if user.is_authenticated %}
		<ul class="identity_menu">
			<li>
				<a href="{% url accounts_profile %}" class="user_username"><span>{% trans "Logged in as" %}</span> {{ user.get_full_name }}</a>
			</li>
			{% if user.is_staff %}
				<li>
					<a href="/admin/">{% trans "Admin" %}</a>
				</li>
			{% endif %}
			<li>
				<a href="{% url accounts_logout %}">{% trans "Logout" %}</a>
			</li>
		</ul>
	{% else %}
		<!--login url here-->
	{% endif %}
{% endblock %}

{% block logo_link_image %}<a class="logo_link" href="{% url home %}"></a>{% endblock %}
{% block slogan_link_image %}{% endblock %}

{% block right_tabs %}
	{% if user.is_authenticated %}
		{% spaceless %}
			<ul class="site_tabs">
				<li id="tab_profile"><a href="{% url accounts_profile %}">{% trans "Profile" %}</a></li>
				<li id="tab_records"><a href="{% url record_index %}">{% trans "Records" %}</a></li>
				<li id="tab_search"><a href="{% url record_search %}">{% trans "Search" %}</a></li>
				<li id="tab_tags"><a href="{% url tag_index %}">{% trans "Tags" %}</a></li>
			</ul>
		{% endspaceless %}
	{% else %}
		{% spaceless %}
			<ul class="site_tabs">
				<li id="tab_home"><a href="{% url home %}">{% trans "Home" %}</a></li>
				<li id="tab_register"><a href="{% url accounts_register %}">{% trans "Register" %}</a></li>
				<li id="tab_login"><a href="{% url accounts_login %}">{% trans "Login" %}</a></li>
			</ul>
		{% endspaceless %}
	{% endif %}
{% endblock %}

{% block containers %}
	<!-- Blank Tag -->
	<div id="tags_blank">
		<ul class="tags">
			<li class="tag"><a class="tag_text" href="{% url record_search tags='' %}"></a> <a href="{% url api-tag tag_name=0,record_id=0,emitter_format='.json' %}" class="closebutton use_tag_delete"></a></li>
		</ul>
	</div>
	
	<!-- Blank Popular Tag -->
	<div id="popular_tags_blank">
		<ul class="tags_chart">
			<li class="popular_tag">
				<div class="label">
					<ul class="tags">
						<li class="tag"></li>
					</ul>
				</div>
				<div class="content">
					<span class="value" style="width: 0%;">0</span>
				</div>
			</li>
		</ul>
	</div>
	
	<!-- Record Delete Confirmation -->
	<div id="record_delete_confirmation">
		<div class="popup">
			<div class="popup_close"></div>
			<div class="actions">
				<a class="input_button_wrapper delete_action">
					<span class="input_button_start"></span>
					<span class="input_button_body">
						<span class="icon icon_record_delete">{% trans "Delete" %}</span>
					</span>
					<span class="input_button_end"></span>
				</a>
				
				<a class="input_button_wrapper cancel_action">
					<span class="input_button_start"></span>
					<span class="input_button_body">
						<span class="icon icon_cancel">{% trans "Cancel" %}</span>
					</span>
					<span class="input_button_end"></span>
				</a>
			</div>
			
			<div class="contents">
				<h5>{% trans "Are you sure? This cannon be undone." %}</h5>
			</div>
		</div>
	</div>
	
	<!-- Tag Delete Confirmation -->
	<div id="tag_all_delete_confirmation">
		<div class="popup">
			<div class="popup_close"></div>
			<div class="actions">
				<a class="input_button_wrapper delete_action">
					<span class="input_button_start"></span>
					<span class="input_button_body">
						<span class="icon icon_tag_delete">{% trans "Delete" %}</span>
					</span>
					<span class="input_button_end"></span>
				</a>
				
				<a class="input_button_wrapper cancel_action">
					<span class="input_button_start"></span>
					<span class="input_button_body">
						<span class="icon icon_cancel">{% trans "Cancel" %}</span>
					</span>
					<span class="input_button_end"></span>
				</a>
			</div>
			
			<div class="contents">
				<h5>{% trans "Are you sure? This cannon be undone." %}</h5>
			</div>
		</div>
	</div>
	
	<!-- Tag Edit -->
	<div id="tag_edit_form">
		<div class="popup">
			<div class="popup_close"></div>
			<form action="" method="put">
				{% csrf_token %}
				<div class="actions">
					<div class="input_button_wrapper edit_action">
						<div class="input_button_start"></div>
						<div class="input_button_body">
							<div class="icon icon_record_save"></div>
							<input type="submit" name="submit" value="{% trans "Save" %}" class="input_submit" />
						</div>
						<div class="input_button_end"></div>
					</div>
					
					<a class="input_button_wrapper cancel_action">
						<span class="input_button_start"></span>
						<span class="input_button_body">
							<span class="icon icon_cancel">{% trans "Cancel" %}</span>
						</span>
						<span class="input_button_end"></span>
					</a>
				</div>
				
				<div class="contents">
					<input name="name" class="tag" type="text" value="" />
				</div>
			</form>
		</div>
	</div>
{% endblock %}

{% block sidebar %}
	<div id="site_sidebar">
		{% if user %}
			<div class="use_tabs sidebar_tabs">
				<ul class="tabs">
					<li class="active"><a href="#sidebar_tab_used">{% trans "Used" %}</a></li>
					<li><a href="#sidebar_tab_popular">{% trans "Popular" %}</a></li>
				</ul>
				
				<div class="tab_container">
					<div id="sidebar_tab_used" class="tab_content">
						{% render_tags used_tags %}
					</div>
					<div id="sidebar_tab_popular" class="tab_content hidden">
						<ul class="tags_chart">
							{% for tag in popular_tags %}
								{% if forloop.counter > 10 %}
									<!-- These are hidden on load... -->
									<li class="popular_tag hidden">
										<div class="label">
											<ul class="tags">
												{% render_tag tag %}
											</ul>
										</div>
										<div class="content">
											<span class="value" style="width: {{ tag.percent }}%;">{{ tag.count }}</span>
										</div>
									</li>
								{% else %}
									<li class="popular_tag">
										<div class="label">
											<ul class="tags">
												{% render_tag tag %}
											</ul>
										</div>
										<div class="content">
											<span class="value" style="width: {{ tag.percent }}%;">{{ tag.count }}</span>
										</div>
									</li>
								{% endif %}
							{% endfor %}
						</ul>
						
						{% if popular_tags|length > 10 %}
							<div class="actions">
								<div class="action">
									<a href="#" class="input_button_wrapper use_tag_popular_show_all">
										<span class="input_button_start"></span>
										<span class="input_button_body">
											<span class="input_button_content icon icon_tags">{% trans "Show All" %}</span>
										</span>
										<span class="input_button_end"></span>
									</a>
								</div>
							</div>
						{% endif %}
					</div>
				</div>
			</div>
		{% endif %}
	</div>
{% endblock sidebar %}

{% block footer %}
	<ul class="footer_items">
		<li><a href="{% url home %}">Home</a></li>
		<li><a href="{% url about %}">About</a></li>
		<li><a href="{% url terms %}">Terms</a></li>
		<li><a href="{% url privacy %}">Privacy</a></li>
	</ul>
{% endblock %}

{% block extra_body_base %}
	<script src="{{ MEDIA_URL }}js/lib/min/jquery-1.4.3.min.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/lib/date.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.fcbkcomplete.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/custom/jquery.base.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/custom/jquery.dropdown_menus.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/custom/jquery.tabs.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.form-2.36.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.infieldlabel.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.elastic.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.timeago.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.blockUI.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.datePicker-2.1.2.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.highlight.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.gritter.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/plugins/jquery.ezpz_hint.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/custom/jquery.gritter_extend.js" type="text/javascript"></script>
	<script src="{{ MEDIA_URL }}js/custom/jquery.sidebar.js" type="text/javascript"></script>
	
	{% block extra_body %}{% endblock %}
	
	<script type="text/javascript">
		var uservoiceOptions = {
			/* required */
			key: 'synapsie',
			host: 'synapsie.uservoice.com', 
			forum: '82185',
			showTab: true,  
			/* optional */
			alignment: 'left',
			background_color:'#f00', 
			text_color: 'white',
			hover_color: '#06C',
			lang: 'en'
		};
		
		function _loadUserVoice() {
			var s = document.createElement('script');
			s.setAttribute('type', 'text/javascript');
			s.setAttribute('src', ("https:" == document.location.protocol ? "https://" : "http://") + "cdn.uservoice.com/javascripts/widgets/tab.js");
			document.getElementsByTagName('head')[0].appendChild(s);
		}
		_loadSuper = window.onload;
		window.onload = (typeof window.onload != 'function') ? _loadUserVoice : function() { _loadSuper(); _loadUserVoice(); };
	</script>
	
	<script type="text/javascript">
		
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-19197706-1']);
		_gaq.push(['_trackPageview']);
		
		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
		
	</script>
{% endblock %}